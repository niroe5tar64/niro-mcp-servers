# 並列タスク分析ルール

## 目的
`tasks.md` 生成時に、安全に並列実行できる実装タスクを一貫した方法で識別する。

## 並列タスクとして扱う条件
以下すべてを満たす場合にのみ並列可能としてマークする:

1. 未完了タスクへの**データ依存**がない。
2. **競合するファイルや共有の可変リソース**に触れない。
3. 事前に**他タスクのレビュー/承認**が不要。
4. 当該タスクに必要な**環境/セットアップ**が既に満たされている、またはタスク内で完結する。

## マーキング規約
- 該当タスクの数値識別子の直後に `(P)` を付ける。
  - 例: `- [ ] 2.1 (P) メール用バックグラウンドワーカーを構築`
- 大タスク/サブタスクの両方で適切に `(P)` を適用する。
- `--sequential` フラグ等で順次実行が指定された場合は `(P)` を一切付けない。
- チェックボックスの完了状態と混同しないよう `(P)` はチェックボックスの**外側**に置く。

## グルーピング & 並び順のガイドライン
- 並列タスクは可能な限り同一テーマの親の下にまとめる。
- 明らかな前提や注意点は詳細箇条書きに記載する（例: 「1.2 のスキーマ移行が必要」）。
- 似たタスクでも並列不可の場合、ブロッキング依存を明示する。
- 自身に実行可能な詳細項目がない「コンテナ専用」の大タスクには `(P)` を付けない。並列評価はサブタスク側で行う。

## 品質チェックリスト
`(P)` を付ける前に以下を確認する:

- 同時実行でもマージ/デプロイの衝突が起きないことを確認した。
- 共有状態の前提が詳細箇条書きに記載されている。
- 実装が独立してテスト可能である。

いずれかが満たせない場合は **`(P)` を付けない**。依存関係はタスク詳細に記載する。
