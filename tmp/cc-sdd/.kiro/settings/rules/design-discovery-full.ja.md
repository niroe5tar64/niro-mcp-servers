# 技術設計のフルディスカバリー手順

## 目的
技術設計が完全で正確かつ最新の情報に基づくよう、包括的な調査と分析を行う。

## ディスカバリー手順

### 1. 要件分析
**要件を技術的ニーズへマッピング**
- EARS 形式から機能要件を抽出
- 非機能要件（性能、セキュリティ、スケーラビリティ）を特定
- 技術制約と依存関係を整理
- 主要な技術課題を列挙

### 2. 既存実装の分析
**現行システムの把握**（変更/拡張の場合）:
- コードベース構造とアーキテクチャパターンを分析
- 再利用可能なコンポーネント/サービス/ユーティリティを把握
- ドメイン境界とデータフローを整理
- 統合ポイントと依存関係を記録
- 方針決定: 拡張 vs リファクタ vs ラップ

### 3. 技術調査
**ベストプラクティスと解決策の調査**:
- **WebSearch を使用**して以下を探す:
  - 類似課題に対する最新のアーキテクチャパターン
  - 技術スタックの業界ベストプラクティス
  - 関連技術の最新アップデートや変更点
  - 代表的な落とし穴と解決策

- **WebFetch を使用**して以下を分析:
  - フレームワーク/ライブラリの公式ドキュメント
  - API リファレンスと利用例
  - 移行ガイドと破壊的変更
  - 性能ベンチマークと比較

### 4. 外部依存の調査
**外部サービス/ライブラリごとに**:
- 公式ドキュメントと GitHub リポジトリを調べる
- API シグネチャと認証方式を検証
- 既存スタックとのバージョン互換性を確認
- レート制限や利用制約を確認
- コミュニティ資料や既知の問題を調査
- セキュリティ上の考慮点を記録
- 実装調査が必要なギャップを記録

### 5. アーキテクチャパターン & 境界分析
**アーキテクチャ選定の検討**:
- 関連パターンの比較（MVC, Clean, Hexagonal, Event-driven）
- 既存アーキテクチャとステアリング原則への適合性
- チーム衝突を避けるためのドメイン境界と責務分割
- スケーラビリティや運用面の影響
- 保守性とチームスキルの評価
- 採用パターンと却下案の理由を `research.md` に記録

### 6. リスク評価
**技術的リスクの特定**:
- 性能ボトルネックとスケール限界
- セキュリティ脆弱性と攻撃ベクトル
- 統合の複雑さと結合度
- 技術的負債の増加/解消
- 知識ギャップと教育ニーズ

## 調査ガイドライン

### 検索が必要な場合
**常に検索するもの**:
- 外部 API のドキュメントと更新情報
- 認証/認可のセキュリティベストプラクティス
- 特定ボトルネックに対する性能最適化
- 依存関係の最新バージョンと移行パス

**不明な場合に検索するもの**:
- 特定ユースケースのアーキテクチャパターン
- データ形式/プロトコルの業界標準
- コンプライアンス要件（GDPR、HIPAA など）
- 想定負荷に対するスケーリング戦略

### 検索戦略
1. 公式ソース（ドキュメント、GitHub）から始める
2. 最近のブログ/記事（直近 6 か月）を確認
3. Stack Overflow で共通課題を調べる
4. 近い OSS 実装を調査する

## 出力要件
設計判断に影響する発見事項は `research.md` に共有テンプレートで記録する:
- アーキテクチャ、技術整合、契約に影響する主要な洞察
- 調査で判明した制約
- 推奨アプローチと選択パターンの根拠
- 却下案とトレードオフ（Design Decisions セクションに記録）
- コンポーネント & インターフェース契約に影響するドメイン境界の更新
- リスクと緩和策
- 実装時に追加調査が必要なギャップ
