---
date: 2025-12-25
topic: 機能選定の理由
---

# 機能選定の理由

## 選定した機能

**スペースツリー取得（`get_space_tree`）**

## 選定理由

### 1. 現状の最大の課題を解決

現在の `get_confluence_page_markdown` はページIDが必須。
しかし、ユーザー（特にLLM）は「どのページIDを指定すべきか」が分からない。

→ ツリー構造を提供することで、LLMが自力で「どこを見るべきか」を判断できる。

### 2. ユースケースに直結

想定ユースケース:
- 「〇〇スペースの設計書を探して」
- 「このスペースに何があるか教えて」

これらを実現するには、まずスペースの全体像を把握する必要がある。

### 3. 既存ツールとの組み合わせで完結

```
get_space_tree → ページ構造を把握
get_confluence_page_markdown → 必要なページの本文を取得
```

2つのツールで「探す→読む」のフローが完成する。

### 4. ページ数が多い環境に適合

ユーザーの環境はページ数がかなり多い。
全ページのMarkdownを一括取得すると：
- APIコールが膨大
- レスポンスが巨大（コンテキスト上限超え）
- 処理時間が長い

→ ツリー構造のみ（本文なし）を返す設計により、軽量・高速に対応。

## 見送った機能と理由

| 機能 | 見送り理由 |
|------|-----------|
| 検索ツール | ツリー取得で「探す」は一定カバーできる。検索は次のステップ |
| ページツリー＋Markdown一括 | ページ数が多いため現実的でない |
| 増分同期 | 定期更新のユースケースは現時点で優先度低 |
| 添付ファイル対応 | まずは本文取得のフローを完成させる |
| ページ作成/更新 | 読み取り系を優先。書き込みは将来検討 |
| コメント取得 | 本文取得が先。コメントは補助的 |

## 将来の拡張パス

1. **検索ツール追加**: CQL/キーワード検索で、より柔軟な探索
2. **スペース一覧取得**: 「どのスペースがあるか」から始められる
3. **増分同期**: 定期的なナレッジ更新に対応
4. **ページ作成/更新**: 双方向同期、ドキュメント自動生成

これらは別機能として追加し、組み合わせで対応する方針。
